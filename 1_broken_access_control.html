<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>DUCA - Broken Access Control</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="">

  <div class="container mt-4">
    <h2 class="mb-4">Broken Access Control</h2>


    <h3 class="mt-2">Scenario #1</h3>
    <p class="mb-4">
      An attacker can simply modify the browser's 'account' parameter to send any desired account number. If not
      correctly verified, the attacker can access any user's account.
    </p>
    <div>
      <div class="row align-items-center g-2">
        <div class="col-auto">
          <label class="col-form-label text-nowrap">
            abc.com/profile?account=
          </label>
        </div>
        <div class="col">
          <input type="text" class="form-control" id="accountInput" placeholder="user1" value="user1">
        </div>
        <div class="col-auto">
          <button type="button" class="btn btn-primary" id="loadBtn">
            Request
          </button>
        </div>
      </div>
      <div id="statusBox" class="alert alert-info mt-4">
        <strong>Logged in as:</strong> user1<br>
        <strong>Access level:</strong> Standard User<br>
        <strong>Credits:</strong> 50
      </div>
    </div>

    <h3 class="mt-4">Scenario #2</h3>
    <p class="mb-4">
      Admin rights are required for access to the admin page. However, there is no proper access control in place to
      prevent standard users from accessing this page by simply navigating to the admin URL.
      The available pages are /user and /admin. If a non-admin user tries to access the /admin page, they should receive
      a "403 Forbidden/Unauthorized" HTTP status. However in this, they are granted access without any restrictions.
    </p>
    <div>
      <div class="row align-items-center g-2">
        <div class="col-auto">
          <label class="col-form-label text-nowrap">
            abc.com/app/
          </label>
        </div>
        <div class="col">
          <input type="text" class="form-control" id="pagePathInput" placeholder="user" value="user">
        </div>
        <div class="col-auto">
          <button type="button" class="btn btn-primary" id="visitPageBtn">
            Visit
          </button>
        </div>
      </div>
      <div id="accessStatusBox" class="alert alert-info mt-4">
        <strong>Logged in as:</strong> user<br>
        <strong>Is user an admin?:</strong> No<br>
        <strong>Current page:</strong> /user<br>
        <strong>HTTP Status:</strong> 200 OK
      </div>
    </div>

    <h5 class="mt-4"><a href="https://owasp.org/Top10/2025/A01_2025-Broken_Access_Control/">Click here</a> to learn more.</h5>
  </div>

  <!-- Scenario #1 -->
  <script>
    const input = document.getElementById("accountInput");
    const button = document.getElementById("loadBtn");
    const statusBox = document.getElementById("statusBox");

    function handleAccess(account) {
      // Default to user1 if empty
      if (!account) {
        account = "user1";
      }

      if (account === "admin") {
        statusBox.className = "alert alert-success mt-4";
        statusBox.innerHTML = `
        <strong>Logged in as:</strong> ADMIN<br>
        <strong>Access level:</strong> FULL ACCESS GRANTED<br>
        <strong>Credits:</strong> 9999
      `;
      } else {
        statusBox.className = "alert alert-info mt-4";
        statusBox.innerHTML = `
        <strong>Logged in as:</strong> ${account}<br>
        <strong>Access level:</strong> Standard User<br>
        <strong>Credits:</strong> 50
      `;
      }
    }

    button.addEventListener("click", () => {
      handleAccess(input.value.trim());
    });
  </script>

  <!-- Scenario #2 -->
  <script>
    const pageInput = document.getElementById("pagePathInput");
    const visitBtn = document.getElementById("visitPageBtn");
    const accessStatusBox = document.getElementById("accessStatusBox");

    visitBtn.addEventListener("click", () => {
      const page = pageInput.value.trim() || "user";
      let status = "200 OK";
      let alertClass = "alert alert-info mt-4";

      // Broken access control:
      // No check whether the user is actually an admin
      if (page === "admin") {
        alertClass = "alert alert-success mt-4";
      }

      accessStatusBox.className = alertClass;
      accessStatusBox.innerHTML = `
      <strong>Logged in as:</strong> user<br>
      <strong>Is user an admin?:</strong> No<br>
      <strong>Current page:</strong> /${page}<br>
      <strong>HTTP Status:</strong> ${status}
    `;
    });
  </script>


</body>

</html>