<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>DUCA - Software Supply Chain Failures</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="styles.css" rel="stylesheet">
</head>

<body>
  <div class="container py-4 py-md-5">
    <div class="d-flex justify-content-between align-items-center mb-4 top-nav">
      <a class="btn btn-outline-dark rounded-pill px-4" href="2_security_misconfigurations.html">Previous</a>
      <a class="btn btn-dark rounded-pill px-4" href="index.html">Home</a>
      <a class="btn btn-outline-dark rounded-pill px-4" href="4_cryptographic_failiures.html">Next</a>
    </div>
    <h2 class="mb-4">Software Supply Chain Failures</h2>

    <h3 class="mt-2">Scenario #1</h3>
    <p class="mb-4">
      An application updates a dependency from an untrusted source without signature verification.
      A tampered package is accepted and executed in production.
    </p>

    <div>
      <div class="row align-items-center g-2">
        <div class="col-auto">
          <label class="col-form-label text-nowrap">Package source</label>
        </div>
        <div class="col">
          <select class="form-select" id="sourceSelect">
            <option value="official">Official registry (signed)</option>
            <option value="mirror">Unknown mirror (unsigned)</option>
            <option value="github">Random GitHub release (unsigned)</option>
          </select>
        </div>
        <div class="col-auto">
          <button type="button" class="btn btn-primary" id="deployBtn">Deploy Update</button>
        </div>
      </div>

      <div id="deployStatusBox" class="alert alert-info mt-4">
        <strong>Package:</strong> payment-sdk@4.2.1<br>
        <strong>Status:</strong> No deployment yet
      </div>
    </div>

    <h3 class="mt-4">Scenario #2</h3>
    <p class="mb-4">
      A malicious dependency includes a post-install script that steals environment secrets and tokens
      from developer machines and CI/CD runners.
    </p>

    <div>
      <div class="row align-items-center g-2">
        <div class="col-auto">
          <label class="col-form-label text-nowrap">Install command</label>
        </div>
        <div class="col">
          <input type="text" class="form-control" id="installCommand" value="npm install analytics-helper@2.7.0" placeholder="npm install package@version">
        </div>
        <div class="col-auto">
          <button type="button" class="btn btn-primary" id="installBtn">Run Install</button>
        </div>
      </div>

      <div id="installStatusBox" class="alert alert-info mt-4">
        <strong>Runner:</strong> ci-build-agent-03<br>
        <strong>Status:</strong> Waiting for install
      </div>
    </div>

    <h5 class="mt-4">
      <a href="https://owasp.org/Top10/2025/A03_2025-Software_Supply_Chain_Failures/">Click here</a>
      to learn more.
    </h5>
  </div>

  <script>
    const sourceSelect = document.getElementById("sourceSelect");
    const deployBtn = document.getElementById("deployBtn");
    const deployStatusBox = document.getElementById("deployStatusBox");

    deployBtn.addEventListener("click", () => {
      const source = sourceSelect.value;

      if (source === "official") {
        deployStatusBox.className = "alert alert-success mt-4";
        deployStatusBox.innerHTML = `
          <strong>Package:</strong> payment-sdk@4.2.1<br>
          <strong>Source:</strong> Official registry (signature valid)<br>
          <strong>Status:</strong> Deployment accepted with integrity checks passed
        `;
      } else {
        deployStatusBox.className = "alert alert-danger mt-4";
        deployStatusBox.innerHTML = `
          <strong>Package:</strong> payment-sdk@4.2.1<br>
          <strong>Source:</strong> Untrusted/unsigned source<br>
          <strong>Status:</strong> Tampered package deployed (supply chain compromise)
        `;
      }
    });
  </script>

  <script>
    const installCommand = document.getElementById("installCommand");
    const installBtn = document.getElementById("installBtn");
    const installStatusBox = document.getElementById("installStatusBox");

    installBtn.addEventListener("click", () => {
      const command = installCommand.value.trim() || "npm install analytics-helper@2.7.0";

      // Demo of post-install compromise in an untrusted package
      installStatusBox.className = "alert alert-warning mt-4";
      installStatusBox.innerHTML = `
        <strong>Runner:</strong> ci-build-agent-03<br>
        <strong>Command:</strong> ${command}<br>
        <strong>Status:</strong> Install completed with hidden postinstall script<br>
        <strong>Leaked data:</strong> NPM_TOKEN, GITHUB_TOKEN, CLOUD_API_KEY exfiltrated
      `;
    });
  </script>
</body>

</html>
